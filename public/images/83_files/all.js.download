!function(){"use strict";var e=self.console,t=Object.freeze({NONE:0,ERROR:1,WARN:2,INFO:3,LOG:4}),n=["error","warn","info","log"],i=void 0!==e&&void 0!==e.log&&void 0!==e.error&&void 0!==e.debug&&void 0!==e.warn&&"function"==typeof Function.prototype.apply,o=void 0,r=void 0,a=function(t,n,i,o){return e[n]?i?e[n](i):e[n]():t.log("----------- "+(i||o)+" ----------- ")},l=function(t){var r=t.level,l={};return l.setLevel=function(e){return r=e,l},l.getLevel=function(){return r||o},n.forEach(function(t){l[t]=function(){for(var o=arguments.length,r=Array(o),a=0;a<o;a++)r[a]=arguments[a];return function(t,o,r){if(i){var a=n.indexOf(o),l=t.getLevel();return~a&&l>=a+1&&e[o].apply(e,r),t}}(l,t,r)}}),l.groupCollapsed=function(e){return a(l,"groupCollapsed",e,"GROUP START")},l.group=function(e){return a(l,"group",e,"GROUP START")},l.groupEnd=function(){return a(l,"groupEnd",null,"GROUP END")},l.debug=l.log,l},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.level=e.level||t.NONE;var n=e.newInstance||!r?l(e):r;return r||e.newInstance||(r=n),n},u={LOCAL:"local",URL:"url",CAMERA:"camera",IMAGE_SEARCH:"image_search",GOOGLE_DRIVE:"google_drive",DROPBOX:"dropbox",FACEBOOK:"facebook",INSTAGRAM:"instagram"},c="upload-finish",s="widget-view-change",f="uw_init",g="uw_mini",p="uw_config",m="uw_prepare",y="uw_prebatch",v="uw_event",b="uw_show",h="uw_hide",w="uw_tags",I="uw_file",_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},C="FileReader"in self&&"FileList"in self&&"Blob"in self,x="fetch"in self,E=Object.prototype.toString,A=function(e){return"string"==typeof e},S=function(e){return"function"==typeof e},M=function(e,t){var n=null;if(e.closest)n=e.closest(t);else{var i=self.document.querySelectorAll(t);i&&i.length&&(n=Array.prototype.find.call(i,function(t){return n=e,!!(t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY);var n}))}return n},P=function(e,t,n,i){var o=document.createElement(e);if(t=t||{},n&&(t.class=n),t){var r=t;Object.keys(r).forEach(function(e){return o.setAttribute(e,r[e])})}if(i){var a=i;Object.keys(a).forEach(function(e){return o.dataset[e]=a[e]})}return o},O=function(e){return A(e)?document.querySelector(e):e},R=function(e){e.parentNode&&e.parentNode.removeChild(e)},j=d(),W=function(e,t){var n,i,o=function(e,n){t.widgetCallback&&t.widgetCallback(n,e)},r=function(e){var t=void 0;try{A(e)&&(t=JSON.parse(e))}catch(t){j.log("[all.comms]: failed to deserialize message: ",e)}return t},a=function(e,n){var i,o,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?{type:e,data:n}:(i=e,o=n,JSON.stringify({type:i,data:o}));t.postMessage(r)},l=((n={})[s]=function(e){t.handleWidgetViewTypeChange(e.info)},n[c]=function(n){if(j.log("[all.comms]: received uploaded file data - ",n),n.info.failed)e.inlineMode&&o(null,n.info),t.triggerEvent("cloudinarywidgetfileuploadfail",[n.info]);else{var i=n.info.uploadInfo,r={event:"success",info:i};t.processUploadResult(i),o(r),t.triggerEvent("cloudinarywidgetfileuploadsuccess",r)}},n),d=((i={})[v]=function(e){e.event&&l[e.event]?l[e.event](e):o({uw_event:!0,data:e})},i[h]=function(){t.hideWidget();var e={event:"close",info:{message:"user closed the widget"}};o(e),t.triggerEvent("cloudinarywidgetclosed",e)},i[m]=function(t){var n=function(e){return a(m,e)},i=e.prepare_upload_params||e.upload_signature;"function"==typeof i?i(function(e){j.log("[all.comms]: received prepared data from client: ",e),n("string"==typeof e?{signature:e}:e)},t.request):"string"==typeof e.upload_signature&&n({signature:e.upload_signature})},i[y]=function(t){if("function"!=typeof e.pre_batch)throw new Error("UploadWidget - pre_batch from handler not found!");e.pre_batch(function(e){j.log("[all.comms]: received pre-batch data from client: ",e),a(y,e)},t.request)},i[w]=function(t){e.get_tags(function(e){j.log("[all.comms]: received tags from client: ",e),a(w,{tags:e})},t.prefix)},i);return window.addEventListener("message",function(t){if(t.origin.match(/cloudinary\.com/)){var n=r(t.data),i=!1;n&&n.widgetId&&n.widgetId===e.widgetId&&(j.log("[all.comms]: received message from widget: "+e.widgetId,n),d[n.type]&&(i=!0,d[n.type](n))),i||j.log("[all.comms]: received invalid message, invalid widget ID or invalid type! ",t.data)}}),{sendMessage:a}},L=1,Z=2,z=8,D=500,G=52,V="right:35px",N=/(left|right)(?::([0-9a-z]*))?$/,T=function(e,t){var n,i,o,r,a={raw:V,side:null,offset:null},l=P("iframe",{frameborder:"no",allow:"camera"}),d=null,u=!1,c=!1,s=!1,f=!1,g=function(){document.body&&(d=null===d?document.body.style.overflow:d,document.body.style.overflow=s&&f?"hidden":d)},p=function(){u&&c&&(l.style.display="none",s=!1,g())},m=function(){u&&c&&(l.style.display="block",s=!0,g(),l.focus())},y=function(){var e,t;e=l,(t||document.body).appendChild(e),document.addEventListener("keyup",function(e){27===e.keyCode&&p()})},v=function(){var t=Math.min(D,window.innerWidth)+"px",n=G+"px";l.setAttribute("width",t),l.setAttribute("height",n),l.style.width=t,l.style.height=n,l.style.top="",l.style.bottom="0",function(){if(e.queue_view_position&&e.queue_view_position!==a.raw||!a.side||!a.offset){a.raw=e.queue_view_position||a.raw;var t=N.exec(a.raw);if(!t)throw new Error("queue_view_position param ("+(e.queue_view_position||"")+') is invalid. (valid ex: "right:35px")');a.side=t[1],a.offset=t[2]||"0"}"left"===a.side?(l.style.left=a.offset,l.style.right=""):(l.style.right=a.offset,l.style.left="")}(),f=!1,g()},b=function(){l.setAttribute("width","100%"),l.setAttribute("height","100%"),l.style.width="100%",l.style.height="100%",l.style.top="0",l.style.left="0",l.style.bottom="",f=u,g()},h=function(){m(),b()},w=function(e){switch(e.type){case L:case Z:b();break;case z:v()}},I=function(t){return l.contentWindow.postMessage(t,e.widgetHost)},_=function(){return c},k=function(){return u},C=function(){p(),u=!1},x=function(e){u=!0,c&&(h(),e&&e.files&&(l.style.display="none"))},E=function e(){l.removeEventListener("load",e),c=!0,t({open:x,close:C,showWidget:m,hideWidget:p,isFrameReady:_,isWidgetOpen:k,postMessage:I,handleWidgetViewTypeChange:w}),h()};i=[],(n=e).debug&&i.push("debug=true"),n.dev&&i.push("dev=true"),n.cloud_name&&i.push("cloud_name="+n.cloud_name),i.push("pmHost="+self.location.protocol+"//"+self.location.host),o=i,r=e.widgetHost+"?"+o.join("&"),l.setAttribute("src",r),l.style.display="none",l.style.border="none",l.style.position="fixed",l.style.background="transparent",l.style.zIndex=e.frameZIndex||"1000000",l.addEventListener("load",E),y()},H=function(e,t,n,i){var o=n&&"object"===(void 0===n?"undefined":_(n))?JSON.stringify(n):n;return x?self.fetch(e,{method:t,body:o,headers:new Headers(i)}):new Promise(function(n,r){var a=new XMLHttpRequest;a.open(t,e),a.onerror=function(){return r(a)},a.ontimeout=function(){return r(a)},a.onload=function(){return n(a)},function(e,t){if(t){var n=t;Object.keys(n).forEach(function(t){return e.setRequestHeader(t,n[t])})}}(a,i),a.send(o)})},U=d(),J="cloudinary-button",F="cloudinary-thumbnails",X="cloudinary-thumbnail",B="cloudinary-delete",Y=function(e){return e.field_name||"image"},q=function(e,t){var n=t.form;return!n&&e&&(n=M(e,"form")),n},K=function(e,t,n){var i=q(t,n);i&&(i=O(i))&&function(e,t,n){var i=P("input",{type:"hidden",name:Y(n)},null,{cloudinaryPublicId:e.public_id});i.value=[e.resource_type,e.type,e.path].join("/")+"#"+e.signature;try{i.dataset.cloudinary=JSON.stringify(e)}catch(e){U.error("[all.pageIntegrations]: failed to add info as serialized data attribute")}t.appendChild(i)}(e,i,n)},Q=function(e,t,n,i,o,r){e.addEventListener("click",function a(l){var d,u="https://api"+((d=o).dev?"-dev":d.staging?"-staging":"")+".cloudinary.com/v1_1/"+o.cloud_name+"/delete_by_token";return U.log("[all.pageIntegrations]: \n        about to send delete request with token: "+i.delete_token+" to : "+u),l.preventDefault(),H(u,"POST",{token:i.delete_token},{"Content-Type":"application/json"}).then(function(l){200===l.status&&(U.log("[all.pageIntegrations]: successfully deleted file"),e.removeEventListener("click",a),function(e,t,n,i){R(e);var o=q(t,i);if(o){var r=o.querySelector('input[name="'+Y(i)+'"][data-cloudinary-public-id="'+n.public_id+'"]');r&&R(r)}}(t,n,i,o),r.triggerEvent("cloudinarywidgetdeleted",i))}).catch(function(e){U.warn("[all.pageIntegrations]: failed to delete file with status: "+e.status)})})},$=function(e,t,n,i){if(!1!==n.thumbnails&&(n.thumbnails||t)){var o=!0,r=O("."+F);if(r||(o=!1,r=P("ul",null,F)),r.appendChild(function(e,t,n,i){var o=P("li",null,X,{cloudinary:JSON.stringify(e)}),r=void 0;e.thumbnail_url?(r=P("img",{src:e.thumbnail_url})).addEventListener("load",function e(){o.classList.add("active"),r.removeEventListener("load",e)}):(r=P("span")).textContent=e.public_id;if(o.appendChild(r),e.delete_token){var a=P("a",{href:"#"},B);a.textContent="x",o.appendChild(a),Q(a,o,t,e,n,i)}return o}(e,t,n,i)),!o){U.log("[all.pageIntegrations]: adding thumbnails list to dom");var a=n.thumbnails&&O(n.thumbnails);a?a.appendChild(r):t&&t.insertAdjacentElement("afterend",r)}}},ee=d(),te=function(e,t){var n=null,i=function(i){return Promise.race(Array.prototype.map.call(i,function(o,r){var a,l,d,u,c,s,f,g,p=Promise.resolve();return C&&o instanceof File?!e.max_file_size||e.max_file_size>0&&o.size<=e.max_file_size?(n||(a=[],l=new FileReader,d=null,u=null,c=function(){d=null,l.removeEventListener("load",s,!1),l.removeEventListener("error",f,!1),u&&(u(),u=null),a.length&&g(a.shift())},s=function(){if(d){var e=d.file;t.sendMessage(I,{lastModified:e.lastModified,lastModifiedDate:e.lastModifiedDate,name:e.name,size:e.size,type:e.type,file:l.result,index:d.index,count:d.count},!0),c()}},f=function(){ee.log("[global.all.uploadsHandler]: failed to read file",l.error),c()},g=function(e){d=e,l.addEventListener("load",s,!1),l.addEventListener("error",f,!1),l.readAsDataURL(e.file)},n={load:function(e,t,n){var i=void 0;return 1!==l.readyState?i=new Promise(function(i){u=i,g({file:e,index:t,count:n})}):(a.push({file:e,index:t,count:n}),i=Promise.resolve()),i}}),p=n.load(o,r,i.length)):ee.log("[global.all.uploadsHandler]: provided file is larger than max file size configured",o):A(o)?t.sendMessage(I,{file:o,index:r,count:i.length}):ee.warn("[global.all.uploadsHandler]: unknown type of object sent to upload",o),p}))};return{handleFiles:function(e){return e&&e.files?i(e.files):Promise.resolve()}}},ne=d(),ie=["keep_widget_open","inline_container","stylesheet"],oe=0,re=function(e){return ie.forEach(function(t){void 0!==e[t]&&function(){var e;(e=console).warn.apply(e,arguments)}("Cloudinary.UploadWidget - "+t+" is no longer used in this version.")})},ae=function(e,t){var n,i=(n=e)&&!Array.isArray(n)&&"[object Object]"===E.call(n)?k({},n):n;return oe+=1,i.widgetId="widget_"+oe,i.secure=i.secure||"https:"===document.location.protocol,i.requirePrepareParams=!!i.prepare_upload_params||!!i.upload_signature,i.useTagsCallback=S(i.get_tags),i.usePreBatchCallback=S(i.pre_batch),e.field_name=e.field_name||t&&t.getAttribute("name")||null,delete i.element,re(e),i},le=function(e,t,n){n=function(e,t){var n=e||t.element;if(n){try{n=O(n)}catch(e){throw new Error("[Cloudinary.UploadWidget]: 'element' param must either be a valid HTMLElement or a selector string")}if(!n||!n.nodeType)throw new Error("[Cloudinary.UploadWidget]: 'element' param must resolve to a valid HTMLElement")}return n}(n,e);var i,o,r=ae(e,n),a=void 0,l=void 0,d=void 0,u=function(e,t){r.$&&r.$(n||r.form||document).trigger(e,t)},c=function(e){return a?a.then(e).catch(function(e){return ne.error("Cloudinary.UploadWidget - encountered error ! ",e)}):ne.error("Cloudinary.UploadWidget - Widget frame API not ready yet!")},s=function(e,t){return c(function(n){n.open(t),n.isFrameReady()&&(l.sendMessage(b,{source:e,options:t},!0),d.handleFiles(t).then(function(){setTimeout(function(){n.showWidget()},150)}))})};return o=function(){var e=r.secure?"https:":"http:",t=void 0;if(!0===r.dev)t="//widget-dev.cloudinary.com/index.html";else{var n="//widget"+(!0===r.staging?"-staging":"")+".cloudinary.com/v2.0/n/";t=r.widgetHost||n+r.cloud_name+"/"+r.widgetVersion+"/index.html"}return t=0!==t.indexOf("http")?e+t:t}(),i=k({},r,{widgetHost:o}),(a=new Promise(T.bind(null,i))).then(function(e){var i,a,c,g;(l=W(k({},r,{widgetHost:o}),k({triggerEvent:u,processUploadResult:function(e){return a={triggerEvent:u},K(t=e,i=n,o=r),void $(t,i,o,a);var t,i,o,a},widgetCallback:t},e))).sendMessage(f,k({},r,{showOnStart:e.isWidgetOpen()})),d=te(r,l),n&&(i=n,a=s,(g=P("a",{href:"#"},(c=r).button_class||J)).innerHTML=c.button_caption||"Upload image",i.style.display="none",i.parentNode&&i.parentNode.insertBefore(g,i.previousSibling),g.addEventListener("click",function(e){return a(),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}))}),{open:function(e,t){return s(e,t),this},update:function(e){var t;return t=e,l.sendMessage(p,t),this},close:function(e){var t;return t=e,c(function(e){e.close(),l.sendMessage(h,t)}),this},hide:function(){return c(function(e){return e.hideWidget()}),this},show:function(){return c(function(e){return e.showWidget()}),this},minimize:function(){return l.sendMessage(g),this}}},de=d();!function(e){var n,i={cloud_name:null,api_key:null},r=e.jQuery?e.jQuery:e.$&&e.$.fn&&e.$.fn.jquery?e.$:null,a=e.location.search.indexOf("debug=true")>-1,l=e.location.search.indexOf("dev=true")>-1;n=a?t.LOG:t.WARN,o=n,function(){try{var e=P("style",{id:"cloudinary-uw-page-styles",type:"text/css"});e.innerHTML=".cloudinary-thumbnails { list-style: none; margin: 10px 0; padding: 0 }\n        .cloudinary-thumbnails:after { clear: both; display: block; content: '' }\n        .cloudinary-thumbnail { float: left; padding: 0; margin: 0 15px 5px 0; display: none } \n        .cloudinary-thumbnail.active { display: block } \n        .cloudinary-thumbnail img { border: 1px solid #01304d; border-radius: 2px; -moz-border-radius: 2px; -webkit-border-radius: 2px } \n        .cloudinary-thumbnail span { font-size: 11px; font-family: Arial, sans-serif; line-height: 14px; border: 1px solid #aaa; max-width: 150px; word-wrap: break-word; word-break: break-all; display: inline-block; padding: 3px; max-height: 60px; overflow: hidden; color: #999; } \n        .cloudinary-delete { vertical-align: top; font-size: 13px; text-decoration: none; padding-left: 2px; line-height: 8px; font-family: Arial, sans-serif; color: #01304d }\n        .cloudinary-button { color: #fefeff; text-decoration: none; font-size: 18px; line-height: 28px; height: 28x; border-radius: 6px; -moz-border-radius: 6px; -webkit-border-radius: 6px; font-weight: normal; text-decoration: none; \n          display: inline-block; padding: 4px 30px 4px 30px; background: #0284cf; font-family: Helvetica, Arial, sans-serif;\n          background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzAyODRjZiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMwMjU5OGIiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+); \n          background: -moz-linear-gradient(top,  #0284cf 0%, #02598b 100%);\n          background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#0284cf), color-stop(100%,#02598b));\n          background: -webkit-linear-gradient(top,  #0284cf 0%,#02598b 100%);\n          background: -o-linear-gradient(top,  #0284cf 0%,#02598b 100%);\n          background: -ms-linear-gradient(top,  #0284cf 0%,#02598b 100%);\n          background: linear-gradient(to bottom,  #0284cf 0%,#02598b 100%);\n          filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#0284cf', endColorstr='#02598b',GradientType=0 ); \n         }\n        .cloudinary-button:hover { background: #02598b; \n          background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzAyNTk4YiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMwMjg0Y2YiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+); \n          background: -moz-linear-gradient(top,  #02598b 0%, #0284cf 100%);\n          background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#02598b), color-stop(100%,#0284cf));\n          background: -webkit-linear-gradient(top,  #02598b 0%,#0284cf 100%);\n          background: -o-linear-gradient(top,  #02598b 0%,#0284cf 100%);\n          background: -ms-linear-gradient(top,  #02598b 0%,#0284cf 100%);\n          background: linear-gradient(to bottom,  #02598b 0%,#0284cf 100%);\n          filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#02598b', endColorstr='#0284cf',GradientType=0 );\n         } ";var t=O("head");t&&t.appendChild(e)}catch(e){de.error("[all.pageStyles]: failed to apply styles")}}();var d=e.cloudinary=e.cloudinary||{};d.applyUploadWidget=function(e,t,n){return le(k({},i,{dev:l,debug:a},t,{widgetVersion:"99",$:r}),n,e)},d.createUploadWidget=function(e,t){return d.applyUploadWidget(null,e,t)},d.openUploadWidget=function(e,t){return d.createUploadWidget(e,t).open()},d.setCloudName=function(e){i.cloud_name=e},d.setAPIKey=function(e){i.api_key=e},d.WIDGET_SOURCES=k({},u),d.WIDGET_VERSION="99",r&&(r.fn.cloudinary_upload_widget=function(e,t){d.applyUploadWidget(r(this)[0],e,t)})}(self)}();
